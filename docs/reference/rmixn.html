<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fast simulation of r.v.s from a mixture of multivariate normal densities — rmixn • mvnfast</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">mvnfast</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/mvnfast.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mfasiolo/mvnfast">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fast simulation of r.v.s from a mixture of multivariate normal densities</h1>
    </div>

    
    <p>Fast simulation of r.v.s from a mixture of multivariate normal densities</p>
    

    <pre class="usage"><span class='fu'>rmixn</span>(<span class='no'>n</span>, <span class='no'>mu</span>, <span class='no'>sigma</span>, <span class='no'>w</span>, <span class='kw'>ncores</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>isChol</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>retInd</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>A</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>kpnames</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>n</th>
      <td><p>number of random vectors to be simulated.</p></td>
    </tr>
    <tr>
      <th>mu</th>
      <td><p>an (m x d) matrix, where m is the number of mixture components.</p></td>
    </tr>
    <tr>
      <th>sigma</th>
      <td><p>as list of m covariance matrices (d x d) on for each mixture component. 
Alternatively it can be a list of m cholesky decomposition of the covariance. 
In that case <code>isChol</code> should be set to <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>w</th>
      <td><p>vector of length m, containing the weights of the mixture components.</p></td>
    </tr>
    <tr>
      <th>ncores</th>
      <td><p>Number of cores used. The parallelization will take place only if OpenMP is supported.</p></td>
    </tr>
    <tr>
      <th>isChol</th>
      <td><p>boolean set to true is <code>sigma</code> is the cholesky decomposition of the covariance matrix.</p></td>
    </tr>
    <tr>
      <th>retInd</th>
      <td><p>when set to <code>TRUE</code> an attribute called "index" will be added to the output matrix of random variables.
This is a vector specifying to which mixture components each random vector belongs. <code>FALSE</code> by default.</p></td>
    </tr>
    <tr>
      <th>A</th>
      <td><p>an (optional) numeric matrix of dimension (n x d), which will be used to store the output random variables.
It is useful when n and d are large and one wants to call <code><a href='rmvn.html'>rmvn()</a></code> several times, without reallocating memory
for the whole matrix each time. NB: the element of <code>A</code> must be of class "numeric".</p></td>
    </tr>
    <tr>
      <th>kpnames</th>
      <td><p>if <code>TRUE</code> the dimensions' names are preserved. That is, the i-th column of the output
has the same name as the i-th entry of <code>mu</code> or the i-th column of <code>sigma</code>. 
<code>kpnames==FALSE</code> by default.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If <code>A==NULL</code> (default) the output is an (n x d) matrix where the i-th row is the i-th simulated vector.
        If <code>A!=NULL</code> then the random vector are store in <code>A</code>, which is provided by the user, and the function
        returns <code>NULL</code>. Notice that if <code>retInd==TRUE</code> an attribute called "index" will be added to A.
        This is a vector specifying to which mixture components each random vector belongs.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Notice that this function does not use one of the Random Number Generators (RNGs) provided by R, but one 
         of the parallel cryptographic RNGs described in (Salmon et al., 2011). It is important to point out that this
         RNG can safely be used in parallel, without risk of collisions between parallel sequence of random numbers.
         The initialization of the RNG depends on R's seed, hence the <code>set.seed()</code> function can be used to 
         obtain reproducible results. Notice though that changing <code>ncores</code> causes most of the generated numbers
         to be different even if R's seed is the same (see example below). NB: at the moment the RNG does not work
         properly on Solaris OS when <code>ncores&gt;1</code>. Hence, <code>rmixn()</code> checks if the OS is Solaris and, if this the case, 
         it imposes <code>ncores==1</code>.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>John K. Salmon, Mark A. Moraes, Ron O. Dror, and David E. Shaw (2011). Parallel Random Numbers: As Easy as 1, 2, 3.
             D. E. Shaw Research, New York, NY 10036, USA.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='co'># Create mixture of two components</span>
<span class='no'>mu</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>rep</span>(<span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>10</span>, <span class='fl'>20</span>), <span class='fl'>2</span>), <span class='fl'>2</span>, <span class='fl'>2</span>, <span class='kw'>byrow</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>sigma</span> <span class='kw'>&lt;-</span> <span class='fu'>list</span>(<span class='fu'>diag</span>(<span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>10</span>)), <span class='fu'>matrix</span>(<span class='fu'>c</span>(<span class='fl'>1</span>, -<span class='fl'>0.9</span>, -<span class='fl'>0.9</span>, <span class='fl'>1</span>), <span class='fl'>2</span>, <span class='fl'>2</span>))
<span class='no'>w</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fl'>0.1</span>, <span class='fl'>0.9</span>)

<span class='co'># Simulate</span>
<span class='no'>X</span> <span class='kw'>&lt;-</span> <span class='fu'>rmixn</span>(<span class='fl'>1e4</span>, <span class='no'>mu</span>, <span class='no'>sigma</span>, <span class='no'>w</span>, <span class='kw'>retInd</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fu'>plot</span>(<span class='no'>X</span>, <span class='kw'>pch</span> <span class='kw'>=</span> <span class='st'>'.'</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='fu'>attr</span>(<span class='no'>X</span>, <span class='st'>"index"</span>))

<span class='co'># Simulate with fixed seed</span>
<span class='fu'>set.seed</span>(<span class='fl'>414</span>)
<span class='fu'>rmixn</span>(<span class='fl'>4</span>, <span class='no'>mu</span>, <span class='no'>sigma</span>, <span class='no'>w</span>)

<span class='fu'>set.seed</span>(<span class='fl'>414</span>)
<span class='fu'>rmixn</span>(<span class='fl'>4</span>, <span class='no'>mu</span>, <span class='no'>sigma</span>, <span class='no'>w</span>)

<span class='fu'>set.seed</span>(<span class='fl'>414</span>)
<span class='fu'>rmixn</span>(<span class='fl'>4</span>, <span class='no'>mu</span>, <span class='no'>sigma</span>, <span class='no'>w</span>, <span class='kw'>ncores</span> <span class='kw'>=</span> <span class='fl'>2</span>) <span class='co'># r.v. generated on the second core are different</span>

<span class='co'>###### Here we create the matrix that will hold the simulated random variables upfront.</span>
<span class='no'>A</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fl'>NA</span>, <span class='fl'>4</span>, <span class='fl'>2</span>)
<span class='fu'>class</span>(<span class='no'>A</span>) <span class='kw'>&lt;-</span> <span class='st'>"numeric"</span> <span class='co'># This is important. We need the elements of A to be of class "numeric". </span>

<span class='fu'>set.seed</span>(<span class='fl'>414</span>)
<span class='fu'>rmixn</span>(<span class='fl'>4</span>, <span class='no'>mu</span>, <span class='no'>sigma</span>, <span class='no'>w</span>, <span class='kw'>ncores</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>A</span> <span class='kw'>=</span> <span class='no'>A</span>) <span class='co'># This returns NULL ...</span>
<span class='no'>A</span>                                         <span class='co'># ... but the result is here</span>

<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Matteo Fasiolo &lt;matteo.fasiolo@gmail.com&gt;, C++ RNG engine by Thijs van den Berg &lt;http://sitmo.com/&gt;.

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Matteo Fasiolo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
